<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Study Plan Dashboard</title>
  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root { color-scheme: light dark; }
    html, body { height: 100%; font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; }
    /* Modal backdrop transition helpers */
    .backdrop-enter { opacity: 0; }
    .backdrop-enter-active { transition: opacity 200ms ease; opacity: 1; }
    .backdrop-exit { opacity: 1; }
    .backdrop-exit-active { transition: opacity 150ms ease; opacity: 0; }
    .modal-enter { transform: translateY(8px) scale(0.98); opacity: 0; }
    .modal-enter-active { transition: all 220ms cubic-bezier(.2,.8,.2,1); transform: translateY(0) scale(1); opacity: 1; }
    .modal-exit { transform: translateY(0) scale(1); opacity: 1; }
    .modal-exit-active { transition: all 170ms ease; transform: translateY(8px) scale(0.98); opacity: 0; }
    /* Scrollbar for sessions list on small screens */
    .thin-scrollbar::-webkit-scrollbar { height: 6px; width: 6px; }
    .thin-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 9999px; }
    .thin-scrollbar::-webkit-scrollbar-track { background: transparent; }
  </style>
</head>
<body class="min-h-screen bg-slate-50 text-slate-800 dark:bg-slate-900 dark:text-slate-100">
  <div class="mx-auto max-w-6xl px-4 py-6">
    <!-- Header -->
    <header class="mb-6 flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between">
      <div>
        <h1 class="text-2xl font-bold tracking-tight">Study Plan Dashboard</h1>
        <p class="text-sm text-slate-500 dark:text-slate-400">Università · Fisiologia — pianificazione, avanzamento e countdown.</p>
      </div>
      <div class="flex items-center gap-2">
        <button id="todayBtn" class="rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm font-medium shadow-sm hover:bg-slate-50 active:translate-y-px dark:border-slate-700 dark:bg-slate-800 dark:hover:bg-slate-700">
          Oggi
        </button>
        <div class="inline-flex overflow-hidden rounded-xl border border-slate-200 bg-white shadow-sm dark:border-slate-700 dark:bg-slate-800">
          <button id="prevMonth" class="px-3 py-2 text-sm hover:bg-slate-50 dark:hover:bg-slate-700" aria-label="Mese precedente">◀</button>
          <div id="currentMonthLabel" class="px-4 py-2 text-sm font-semibold min-w-[9rem] text-center select-none">—</div>
          <button id="nextMonth" class="px-3 py-2 text-sm hover:bg-slate-50 dark:hover:bg-slate-700" aria-label="Mese successivo">▶</button>
        </div>
      </div>
    </header>

    <!-- Stats -->
    <section class="mb-6 grid grid-cols-1 gap-4 sm:grid-cols-3">
      <div class="rounded-2xl border border-slate-200 bg-white p-4 shadow-sm dark:border-slate-700 dark:bg-slate-800">
        <div class="flex items-center justify-between">
          <h2 class="text-sm font-semibold text-slate-600 dark:text-slate-300">Completamento</h2>
          <span id="completionPct" class="text-sm font-bold">0%</span>
        </div>
        <div class="mt-2 h-2 w-full overflow-hidden rounded-full bg-slate-200 dark:bg-slate-700">
          <div id="progressBar" class="h-2 rounded-full bg-emerald-500" style="width: 0%"></div>
        </div>
        <p id="completionCount" class="mt-2 text-xs text-slate-500 dark:text-slate-400">0 / 0 giorni studio</p>
      </div>
      <div class="rounded-2xl border border-slate-200 bg-white p-4 shadow-sm dark:border-slate-700 dark:bg-slate-800">
        <h2 class="text-sm font-semibold text-slate-600 dark:text-slate-300">Countdown all’esame</h2>
        <p id="countdown" class="mt-2 text-3xl font-extrabold tracking-tight">—</p>
        <p class="text-xs text-slate-500 dark:text-slate-400">Data esame: 24 Set 2025</p>
      </div>
      <div class="rounded-2xl border border-slate-200 bg-white p-4 shadow-sm dark:border-slate-700 dark:bg-slate-800">
        <h2 class="text-sm font-semibold text-slate-600 dark:text-slate-300">Legenda</h2>
        <ul class="mt-2 grid grid-cols-2 gap-2 text-sm">
          <li class="flex items-center gap-2"><span class="h-3 w-3 rounded-full bg-sky-500"></span>Studio</li>
          <li class="flex items-center gap-2"><span class="h-3 w-3 rounded-full bg-amber-500"></span>Consolidamento</li>
          <li class="flex items-center gap-2"><span class="h-3 w-3 rounded-full bg-fuchsia-500"></span>Simulazione</li>
          <li class="flex items-center gap-2"><span class="h-3 w-3 rounded-full bg-slate-400"></span>Pausa</li>
          <li class="col-span-2 flex items-center gap-2"><span class="h-3 w-3 rounded-full bg-emerald-600"></span>Esame</li>
        </ul>
        <div class="mt-3 flex items-center gap-2 text-sm">
          <span class="inline-flex h-5 w-5 items-center justify-center rounded-full border border-emerald-600 text-emerald-600">✓</span>
          <span>Giorno completato</span>
        </div>
      </div>
    </section>

    <!-- Calendar -->
    <section class="rounded-2xl border border-slate-200 bg-white p-3 shadow-sm dark:border-slate-700 dark:bg-slate-800">
      <div class="grid grid-cols-7 gap-1 px-1 pb-1 text-center text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-400">
        <div>Lun</div><div>Mar</div><div>Mer</div><div>Gio</div><div>Ven</div><div>Sab</div><div>Dom</div>
      </div>
      <div id="calendarGrid" class="grid grid-cols-7 gap-1"></div>
    </section>
  </div>

  <!-- Modal -->
  <div id="modalRoot" class="fixed inset-0 z-[100] hidden">
    <div id="modalBackdrop" class="fixed inset-0 bg-black/40"></div>
    <div id="modalPanel" class="pointer-events-auto fixed inset-x-3 bottom-6 mx-auto max-w-xl rounded-2xl border border-slate-200 bg-white shadow-2xl dark:border-slate-700 dark:bg-slate-800 sm:inset-auto sm:top-1/2 sm:mx-auto sm:-translate-y-1/2">
      <div class="flex items-center justify-between gap-2 border-b border-slate-200 p-4 dark:border-slate-700">
        <div class="min-w-0">
          <h3 id="modalTitle" class="truncate text-lg font-bold">—</h3>
          <p id="modalDate" class="text-xs text-slate-500 dark:text-slate-400">—</p>
        </div>
        <button id="closeModal" class="rounded-xl border border-slate-200 bg-white px-2 py-1 text-sm hover:bg-slate-50 dark:border-slate-700 dark:bg-slate-800 dark:hover:bg-slate-700" aria-label="Chiudi">✕</button>
      </div>
      <div class="max-h-[60vh] overflow-y-auto p-4 thin-scrollbar">
        <div class="mb-3 flex flex-wrap items-center gap-2">
          <span id="typeBadge" class="inline-flex items-center rounded-full px-2.5 py-1 text-xs font-semibold ring-1 ring-inset ring-slate-200 dark:ring-slate-700">—</span>
          <span class="text-xs text-slate-500 dark:text-slate-400">Anki: <span id="ankiText" class="font-medium text-slate-700 dark:text-slate-200">—</span></span>
        </div>
        <ul id="sessionsList" class="space-y-3"></ul>
      </div>
      <div class="flex items-center justify-between gap-3 border-t border-slate-200 p-3 dark:border-slate-700">
        <button id="toggleComplete" class="flex items-center gap-2 rounded-xl bg-emerald-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-emerald-700 active:translate-y-px">
          ✓ Segna come completato
        </button>
        <button id="unmarkComplete" class="hidden rounded-xl border border-slate-300 px-3 py-2 text-sm font-medium hover:bg-slate-50 dark:border-slate-600 dark:hover:bg-slate-700">
          Annulla completamento
        </button>
      </div>
    </div>
  </div>

  <!-- Data & Logic -->
  <script src="./data.js"></script>
  <script src="./script.js"></script>
</body>
</html>